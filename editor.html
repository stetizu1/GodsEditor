<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Editor</title>
    <link rel="stylesheet" href="css.css">
</head>
<body>

<div class="editor">
    <input type="file" class="wide" id="load">
    <div class="tools wide">
        <button id="cutout" class="button">Upravit výřez</button>

        <input type="checkbox" name="tool" id="blur" value="blur">
        <label for="blur" class="button"> Rozmazání obličeje </label>

        <button id="turnLeft" class="button">Otočit vlevo</button>
        <button id="turnRight" class="button">Otočit vpravo</button>
    </div>
    <div class="svgContainer">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svg">
                <defs id="defs">
                    <filter id="blurFilter" y="-5" height="40">
                        <feGaussianBlur in="SourceGraphic" stdDeviation="3" y="-5"/>
                    </filter>
                </defs>
            </svg>
            <div class="confirm">
                <button id="cutoutConfirm" class="button" style="display: none;">Potvrdit výřez</button>
                <div style="height: 20px"></div>
            </div>
        </div>
        <div id="minGallery">
            <div class="cutoutItem">
                <button id="portBig" class="button">Upravit výřez</button>
                <div class="galleryItem" id="galleryMin1" style="width: 150px; height: 200px;">
                    <canvas id="cutoutMin1" class="cutout"></canvas>
                </div>
                <span class="mini">150x200px</span>
            </div>
            <div class="cutoutItem">
                <button id="landscape" class="button">Upravit výřez</button>
                <div class="galleryItem" id="galleryMin2" style="width: 300px; height: 200px;">
                    <canvas id="cutoutMin2" class="cutout"></canvas>
                </div>
                <span class="mini">300x200px</span>
            </div>
        </div>
    </div>

    <div class="canvasContainer" style="visibility: hidden; position: absolute; z-index: -1000;">
        <canvas id="full00" class="full0"></canvas>
    </div>

    <button id="save" class="button wide">Uložit</button>
    <a id="downloadFull" class="button wide">Stáhnout full</a>


    <div id="gallery">
        <div class="galleryItem" id="gallery1" style="height: 160px; width: 110px;">
            <canvas id="cutout00" class="cutout"></canvas>
        </div>
    </div>

</div>
<script src="js/settings/ImageLimits.js"></script>
<script src="js/settings/Messages.js"></script>

<script src="js/FileManager.js"></script>
<script src="js/SVGController.js"></script>
<script src="js/CanvasController.js"></script>
<script src="js/Rotator.js"></script>
<script src="js/BlurFace.js"></script>
<script src="js/Cutout.js"></script>
<script>

var SVGInst = new SVGController('svg');

var mainCanvas = new CanvasController('full00', SVGInst, ImageLimits.MAX_WIDTH, ImageLimits.MAX_HEIGHT);
var galleryCanvas = new CanvasController('cutout00', SVGInst, ImageLimits.MIN_WIDTH, ImageLimits.MIN_HEIGHT );
var cutout1Canvas = new CanvasController('cutoutMin1', SVGInst, 150, 200);
var cutout2Canvas = new CanvasController('cutoutMin2', SVGInst, 300, 200);

mainCanvas.setCanvasSave('downloadFull', '00.jpg');

var rotator = new Rotator(SVGInst);
rotator.setRotation("turnLeft", false);
rotator.setRotation("turnRight", true);

var fileManagement = new FileManager(SVGInst, mainCanvas, true);
var cutoutFileManager = new FileManager(SVGInst, galleryCanvas, false);
var cutout1FileManager = new FileManager(SVGInst, cutout1Canvas, false);
var cutout2FileManager = new FileManager(SVGInst, cutout2Canvas, false);


fileManagement.selectFile('load');
cutoutFileManager.selectFile('load');
cutout1FileManager.selectFile('load');
cutout2FileManager.selectFile('load');

var cutout = new Cutout(SVGInst, "cutoutConfirm");
var blur = new BlurFace('blur', SVGInst);

fileManagement.drawImageOnCanvas('save');

cutout.setCutable('cutout', 320, 480, 640, "cutout00", "gallery1", cutoutFileManager);

cutout.setCutable('portBig', 150, 200, 150,  "cutoutMin1", "galleryMin1", cutout1FileManager);
cutout.setCutable('landscape', 300, 200, 300, "cutoutMin2", "galleryMin2", cutout2FileManager);

blur.setOff('blur', 'cutout');
blur.setOff('blur', 'portBig');
blur.setOff('blur', 'landscape');

</script>
</body>
</html>